#!/usr/bin/env python2

mem=[0x22, 0x47, 0x00, 0x3d, 0x53, 0x77, 0x23, 0x3d, 0x45, 0x77, 0x23, 0x3d, 0x43,
0x77, 0x23, 0x77, 0x23, 0xc5, 0x0c, 0x77, 0x23, 0xc5, 0xfd, 0x77, 0x23, 0x3d,
0x7b, 0x77, 0x23, 0x39, 0x44, 0x00, 0x47, 0xc5, 0x46, 0x31, 0x44, 0x00, 0x78,
0x31, 0x46, 0x00, 0xfd, 0x22, 0xf9, 0x1e, 0x00, 0xfd, 0x7b, 0xf1, 0x1e, 0x00,
0x77, 0x23, 0x39, 0x45, 0x00, 0x3e, 0x31, 0x45, 0x00, 0xc1, 0x1e, 0x00, 0x3d,
0x7d, 0x77, 0x75, 0x03, 0x0b, 0x09]
mem+=[0x00]*(0x67-len(mem))
mem[0x66]=0xc3 # setup()での追加分

mem=[(i&0b11111100)|(i&1)<<1|(i&2)>>1 for i in mem] # bit0<->bit1
mem=b"".join([b"%c"%i for i in mem])
open("fw.bin","wb").write(mem)

import binascii
flag=binascii.a2b_hex(b"534643434f4d7b485c2b703f532267364a7e")

flag=[(i&0b11111100)|(i&1)<<1|(i&2)>>1 for i in flag] # bit0<->bit1

print(''.join(map(chr, flag)))